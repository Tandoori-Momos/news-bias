{"version":3,"sources":["../../../src/tasks/WebScraper/MediaListing.js"],"names":["MediaOutlet","require","module","exports","page","bias","deleteMany","err","Error","goto","console","log","evaluate","containerDiv","document","getElementsByClassName","parentDiv","querySelectorAll","els","elsText","i","length","querySelector","innerText","replace","BiasList","media","listing","name","save"],"mappings":";;;;;;;;;;;;;;;;AAAA,IAAMA,cAAcC,QAAQ,4BAAR,CAApB;;AAEAC,OAAOC,OAAP;AAAA,wFAAiB,iBAAOC,IAAP,EAAaC,IAAb;AAAA;;AAAA;AAAA;AAAA;AAAA;AACb;AACAL,oCAAYM,UAAZ,CAAuB;AACnBD,kCAAMA;AADa,yBAAvB,EAEG,UAASE,GAAT,EAAc;AACb,gCAAIA,GAAJ,EAAS;AACL,sCAAM,IAAIC,KAAJ,CAAUD,GAAV,CAAN;AACH;AACJ,yBAND;;AAFa;AAAA,+BAWPH,KAAKK,IAAL,CAAU,oCAAoCJ,IAA9C,CAXO;;AAAA;;AAabK,gCAAQC,GAAR,qCAA+CN,IAA/C;;AAba;AAAA,+BAeUD,KAAKQ,QAAL,CAAc,YAAM;AACvC,gCAAMC,eAAgBC,SAASC,sBAAT,CAAgC,gBAAhC,CAAD,CAAoD,CAApD,CAArB;AACA,gCAAMC,YAAaH,aAAaI,gBAAb,CAA8B,OAA9B,CAAD,CAAyC,CAAzC,CAAlB;AACA,gCAAMC,MAAMF,UAAUC,gBAAV,CAA2B,IAA3B,CAAZ;;AAEA,gCAAIE,UAAU,EAAd;;AAEA,iCAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,IAAIG,MAAxB,EAAgCD,GAAhC,EAAqC;AACnC,oCAAIF,IAAIE,CAAJ,EAAOE,aAAP,CAAqB,GAArB,CAAJ,EAA+B;AAC7BH,4CAAQC,CAAR,IAAaF,IAAIE,CAAJ,EAAOE,aAAP,CAAqB,GAArB,EAA0BC,SAA1B,CAAoCC,OAApC,CAA4C,IAA5C,EAAkD,EAAlD,EAAsDA,OAAtD,CAA8D,kBAA9D,EAAkF,EAAlF,CAAb;AACD;AACF;;AAED,mCAAOL,OAAP;AACH,yBAdsB,CAfV;;AAAA;AAePM,gCAfO;AAAA;AAAA;AAAA;AAAA;;;AA+Bb,oEAAkBA,QAAlB,qGAA4B;AAAnBC,iCAAmB;AACpBC,mCADoB,GACV,IAAI3B,WAAJ,CAAgB;AAC1B4B,sCAAMF,KADoB;AAE1BrB,sCAAMA;AAFoB,6BAAhB,CADU;;;AAMxBsB,oCAAQE,IAAR;AACH;;AAtCY;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAwCbnB,gCAAQC,GAAR,4BAAsCN,IAAtC;;AAxCa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAjB;;AAAA;AAAA;AAAA;AAAA","file":"MediaListing.js","sourcesContent":["const MediaOutlet = require('./../../models/media-model');\n\nmodule.exports = async (page, bias) => {\n    // Clear out all media outlet listings with the requested bias \n    MediaOutlet.deleteMany({\n        bias: bias\n    }, function(err) {\n        if (err) { \n            throw new Error(err) \n        };\n    });\n   \n\n    await page.goto('https://mediabiasfactcheck.com/' + bias);\n\n    console.log(`Started generating listing for ${ bias } outlets`);\n\n    const BiasList = await page.evaluate(() => {\n        const containerDiv = (document.getElementsByClassName('entry clearfix'))[0];\n        const parentDiv = (containerDiv.querySelectorAll('table'))[0];\n        const els = parentDiv.querySelectorAll('tr');\n        \n        let elsText = [];\n\n        for (let i = 0; i < els.length; i++) {\n          if (els[i].querySelector('a')) {\n            elsText[i] = els[i].querySelector('a').innerText.replace('\\n', '').replace('/ \\([\\s\\S]*?\\)/g', '');      \n          }      \n        }\n\n        return elsText;\n    }); \n    \n    for (let media of BiasList) {\n        let listing = new MediaOutlet({\n            name: media, \n            bias: bias, \n        });\n\n        listing.save();\n    }\n\n    console.log(`Generated listing for ${ bias } media outlet`);\n}"]}